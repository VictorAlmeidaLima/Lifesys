SELECT
/*Nome: CLIENTE - Tipo: INTEGER - Tamanho: 4 - Preenchimento Obrigatório -  - Identificação no Sistema de Atendimento.*/
CON.CODPARC AS CLIENTE,
/*Nome: SISTEMA - Tipo: VARCHAR - Tamanho: 12 - Preenchimento Obrigatório -  */
(SELECT IDENTIFICACAO FROM TCSPRJ PROJ WHERE CON.CODPROJ = PROJ.CODPROJ) AS SISTEMA,
/*Nome: RESPONSAVEL - Tipo: VARCHAR - Tamanho: 50 -  -*/
(SELECT NOMECONTATO FROM TGFCTT CTT WHERE CON.CODIMPLANT = CTT.CODCONTATO AND CON.CODPARC = CTT.CODPARC) AS RESPONSAVEL,
/*Nome: NUMERO - Tipo: VARCHAR - Tamanho: 10 -  -*/
CON.AD_NCONTRATO AS NUMERO,

/*Nome: ASSINADO - Tipo: VARCHAR - Tamanho: 50 -  -  */
(SELECT NOMECONTATO FROM TGFCTT CTT WHERE CON.CODIMPLANT = CTT.CODCONTATO AND CON.CODPARC = CTT.CODPARC) AS ASSINADO,

/*Nome: DATASS - Tipo: DATE - Tamanho: 4 -  - */
FORMAT(CON.DTCONTRATO,'dd/MM/yyyy') AS DATASS,

/*Nome: DATAADESAO - Tipo: DATE - Tamanho: 4 -  -*/
FORMAT(CON.DTCONTRATO,'dd/MM/yyyy') AS DATAADESAO,

/*Nome: VALORADESAO - Tipo: INTEGER - Tamanho: 4 -  - */
ROUND(ISNULL(CON.AD_VRADESAO,0),2) AS VALORADESAO,
/*Nome: VALORMENSA - Tipo: INTEGER - Tamanho: 4 -  -*/
ROUND(SANKHYA.GET_VLR_CONTRATO(CON.NUMCONTRATO),2) AS VALORMENSA,

/*Nome: DATA_ENCERRAMENTO - Tipo: DATE - Tamanho: 4 -  - */
FORMAT(CON.AD_DHINATIVO,'dd/MM/yyyy') AS DATA_ENCERRAMENTO,

/*Nome: CPF_RESPONSAVEL - Tipo: VARCHAR - Tamanho: 12 -  -*/
(SELECT CPF FROM TGFCTT CTT WHERE CON.CODIMPLANT = CTT.CODCONTATO AND CON.CODPARC = CTT.CODPARC) AS CPF_RESPONSAVEL,
/*Nome: CPF_ASSINADO - Tipo: VARCHAR - Tamanho: 12 -  -  */
(SELECT CPF FROM TGFCTT CTT WHERE CON.CODIMPLANT = CTT.CODCONTATO AND CON.CODPARC = CTT.CODPARC) AS CPF_ASSINADO,

/*Nome: INDICE_REAJUSTE - Tipo: VARCHAR - Tamanho: 20 -  -*/
(SELECT RTRIM(MOE_ALT.NOMEMOEDA)+RTRIM('-'+MOE.NOMEMOEDA)  FROM TCSCON CON_INTER
LEFT JOIN TSIMOE MOE_ALT ON CON_INTER.CODMOEALTREAJ = MOE_ALT.CODMOEDA
LEFT JOIN TSIMOE MOE ON CON_INTER.CODMOEDA = MOE.CODMOEDA WHERE CON_INTER.NUMCONTRATO = CON.NUMCONTRATO) AS INDICE_REAJUSTE,

/*Nome: TESTEMUNHA - Tipo: VARCHAR - Tamanho: 50 -  -*/
CON.AD_TESTEMUNHA AS TESTEMUNHA,

/*Nome: CPF_TESTEMUNHA - Tipo: VARCHAR - Tamanho: 20 -  -*/
CON.AD_CPFTESTEMUNHA AS CPF_TESTEMUNHA,

/*Nome: INICIO_PAGAMENTO - Tipo: DATE - Tamanho: 4 -  -
APENAS NA INCLUSÃO DE NOVOS CONTRATOS - PRIMEIRO FATUR*/
'' AS INICIO_PAGAMENTO,

/*Nome: BANCO_DADOS - Tipo: VARCHAR - Tamanho: 30 -  -*/
CASE WHEN CON.AD_TIPBANCO = 'F' THEN 'FIREBIRD' WHEN CON.AD_TIPBANCO = 'S' THEN 'SQL'ELSE ' ' END AS BANCO_DADOS


FROM TCSCON CON
WHERE CON.CODPARC <> 0
